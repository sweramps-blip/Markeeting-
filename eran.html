<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Power Star | Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { --blue: #007bff; --bg: #0a1128; --card: #151b2d; --text: #ffffff; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; }
        
        /* Blue Header Bar like your screenshot */
        .top-bar { width: 100%; background: var(--blue); padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; font-weight: 600; font-size: 14px; position: sticky; top: 0; z-index: 100; }
        .top-bar div { display: flex; align-items: center; gap: 5px; }

        .main-container { width: 100%; max-width: 400px; padding: 15px; box-sizing: border-box; }
        
        /* Question Area */
        .q-box { background: var(--card); border-radius: 10px; padding: 40px 20px; text-align: center; margin-top: 20px; min-height: 150px; }
        .q-text { font-size: 18px; direction: rtl; line-height: 1.6; margin-bottom: 30px; }
        
        /* Options Grid like your screenshot */
        .opt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .opt-btn { background: #1e263d; border: 1px solid #3d4b6e; padding: 15px; border-radius: 8px; color: #fff; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .opt-btn:active { background: #2a344d; }
        .correct { background: #28a745 !important; border: none; }
        .wrong { background: #dc3545 !important; border: none; }

        /* Banner Ad Area inside layout */
        .ad-container { width: 100%; background: #fff; border-radius: 5px; margin: 20px 0; overflow: hidden; display: flex; justify-content: center; align-items: center; min-height: 250px; }

        /* Submit Button */
        .submit-btn { width: 100%; background: var(--blue); color: white; padding: 15px; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; text-transform: uppercase; }

        /* Bottom Sticky Ad */
        #bottomAd { position: fixed; bottom: 0; width: 100%; height: 50px; background: #000; display: flex; justify-content: center; z-index: 1000; }
        
        /* Overlays */
        #adBox { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:10000; flex-direction:column; align-items:center; justify-content:center; }
    </style>
</head>
<body>

<div class="top-bar" id="statBar" style="display:none;">
    <div><i class="fas fa-wallet"></i> Balance: <span id="bal">0</span> PKR</div>
    <div>Daily: <span id="lim">0/20</span></div>
</div>

<div class="main-container">
    <div id="regS" style="display:none; padding: 20px; background: var(--card); border-radius: 15px;">
        <h2 style="text-align:center;">Membership</h2>
        <input id="i" type="text" placeholder="Enter ID" style="width:100%; padding:12px; margin:10px 0; border-radius:5px; border:none;">
        <button class="submit-btn" onclick="checkAuth()">LOGIN</button>
        <p style="font-size:12px; text-align:center; color:#94a3b8; margin-top:15px;">Fees: Rs 200 (Life Time)</p>
    </div>

    <div id="quizS" style="display:none;">
        <div class="q-box">
            <div id="qT" class="q-text">Loading...</div>
            <div id="qG" class="opt-grid"></div>
        </div>

        <div class="ad-container">
            <script type="text/javascript">
                atOptions = { 'key' : '577f75aa7d65a7ccebfa35e124c256c4', 'format' : 'iframe', 'height' : 250, 'width' : 300, 'params' : {} };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/577f75aa7d65a7ccebfa35e124c256c4/invoke.js"></script>
        </div>

        <button class="submit-btn" id="mB" onclick="h()">جواب جمع کریں</button>
    </div>
</div>

<div id="adBox">
    <div id="aT" style="margin-bottom:20px; color: #d4ff00;">Ad Closing in 20s...</div>
    <div id="adArea">
        </div>
    <button id="cB" onclick="cA()" style="display:none; margin-top:20px; padding:10px 30px; background:#d4ff00; border:none; border-radius:20px; font-weight:bold;">CLOSE AD</button>
</div>

<div id="bottomAd">
    <script type="text/javascript">
        atOptions = { 'key' : '8e5d0a2f589886f4a8e80735048956e1', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/8e5d0a2f589886f4a8e80735048956e1/invoke.js"></script>
</div>

<script>
    const API = "https://script.google.com/macros/s/AKfycbyD4XH_WPLQBnRyLxIGTLxhXJ0OY6cnZLQvNgrmIqkAC9RTMdtxgdEXG4h17uKz-sZhZQ/exec";
    let u = { id: localStorage.getItem("psID"), p: 0, ad: 0, bal: 0 }, qs = [], cur, sel;

    async function checkAuth() {
        let id = document.getElementById("i").value || u.id;
        if (!id) return show("regS");
        let r = await fetch(API + "?checkID=" + id);
        let res = await r.json();
        if (res.status === "Approved") {
            u.id = id; localStorage.setItem("psID", id);
            setup();
        } else if (res.status === "Pending") {
            Swal.fire("Pending", "Verification in progress", "info");
        } else {
            show("regS");
        }
    }

    function show(id) {
        document.getElementById("regS").style.display = "none";
        document.getElementById("quizS").style.display = "none";
        document.getElementById(id).style.display = "block";
        if (id === "quizS") document.getElementById("statBar").style.display = "flex";
    }

    async function setup() {
        show("quizS");
        let r = await fetch(API);
        qs = await r.json();
        next();
    }

    function next() {
        sel = null; document.getElementById("mB").innerText = "جواب جمع کریں";
        cur = qs[Math.floor(Math.random() * qs.length)];
        document.getElementById("qT").innerText = cur.q;
        let h = ""; cur.a.forEach((o, i) => { h += `<button class="opt-btn" onclick="s(${i}, this)">${o}</button>`; });
        document.getElementById("qG").innerHTML = h;
        document.getElementById("lim").innerText = u.p + "/200";
    }

    function s(i, b) { 
        if(document.getElementById("mB").innerText === "اگلا سوال") return;
        sel = {i, b}; 
        document.querySelectorAll(".opt-btn").forEach(x => x.style.border = "1px solid #3d4b6e");
        b.style.border = "2px solid #007bff"; 
    }

    function h() {
        let b = document.getElementById("mB");
        if (b.innerText === "اگلا سوال") { 
            u.p++; u.ad++; 
            if (u.ad >= 10) triggerAd(); else next(); 
            return; 
        }
        if (!sel) return;
        if (sel.i == cur.c) { sel.b.classList.add("correct"); u.bal += 0.4; }
        else { sel.b.classList.add("wrong"); document.querySelectorAll(".opt-btn")[cur.c].classList.add("correct"); }
        document.getElementById("bal").innerText = u.bal.toFixed(1);
        b.innerText = "اگلا سوال";
    }

    function triggerAd() {
        document.getElementById("adBox").style.display = "flex";
        let sec = 20; let t = setInterval(() => {
            sec--; document.getElementById("aT").innerText = `Ad Closing in ${sec}s...`;
            if (sec <= 0) { clearInterval(t); document.getElementById("cB").style.display = "block"; }
        }, 1000);
    }

    function cA() { document.getElementById("adBox").style.display="none"; document.getElementById("cB").style.display="none"; u.ad=0; next(); }

    if (u.id) checkAuth(); else show("regS");
</script>
</body>
</html>
